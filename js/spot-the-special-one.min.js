var XMing=XMing||{};XMing.GameStateManager=new function(){var e;var t=0;var n;var r;var i=[{available:["i"],special:"l"},{available:["O"],special:"0"},{available:["0"],special:"O"},{available:["5"],special:"S"},{available:["p"],special:"q"},{available:["8"],special:"3"},{available:["m"],special:"nn"},{available:["w"],special:"vv"},{available:["u"],special:"&#xB5;"},{available:["x"],special:"&#10008;"},{available:["d"],special:"cl"},{available:["O"],special:"Q"},{available:["3","6","8","9","0"],special:"S"},{available:["a","e","i","o","u"],special:"n"},{available:["v","w","x","y","z"],special:"u"},{available:["V","W","X","Y"],special:"M"}];var s=_.range(_.size(i));var o={INITIAL:"initial",START:"start",PAUSE:"pause",END:"end"};this.init=function(){window.addEventListener("resize",this.onResize.bind(this),false);this.initGame()};this.loadData=function(){var e=this;var o=_.sample(s);s=_.without(s,o);var u=i[o];var a=Math.ceil(15/_.size(u.available));var f=[];_.times(a,function(){f=f.concat(u.available)});f=_.sample(f,15);var l=[];_.each(f,function(e){l.push("<li><div class='content animated fadeIn'>"+e+"</div></li>")});l.push("<li><div class='content animated fadeIn' data-special='true'>"+u.special+"</div></li>");l=_.shuffle(l);$(".game-grid").html("");_.each(l,function(e){$(".game-grid").append(e)});this.onResize();$("html, body").scrollTop($("#panel-container").offset().top);r=3.5;(function c(){r-=.5;$("#timer-value").html(Math.ceil(r));$("#timer-value").addClass("animated fadeIn");$("#score-value").html(t);if(r<=0){clearTimeout(n);$("#result-content").html("Time's up!").addClass("animated bounceIn").css("color","rgba(17, 189, 255, 255)");$("#timer-value").removeClass("animated fadeIn");e.loadNextRound()}else{n=setTimeout(c,500)}})();$("ul.game-grid li").click(function(){if($(this.firstChild).data("special")){$("#result-content").html("Correct!").addClass("animated bounceIn").css("color","rgba(0, 255, 0, 255)");t+=r*10;$(".score-change").html("+"+r*10).css("color","rgba(0, 255, 0, 255)")}else{$("#result-content").html("Wrong!").addClass("animated bounceIn").css("color","rgba(255, 0, 0, 255)");t-=r*10;$(".score-change").html("-"+r*10).css("color","rgba(255, 0, 0, 255)")}$("#timer-value").removeClass("animated fadeIn");$("#score-value").html(t);$(".score-change").animate({top:"-25px"},{duration:1e3,complete:function(){$(".score-change").html("").css("top","-10px")}});clearTimeout(n);e.loadNextRound()})};this.loadNextRound=function(){var e=this;var t=$("ul.game-grid");$("#result").width(t.width()).height(t.height()).show();_.delay(function(){$("#result").hide();if(_.size(s)>0){e.loadData()}else{e.endGame()}},1e3)};this.onResize=function(e){var t=$(".game-grid").children("li");var n=_.max(t,function(e){return $(e).width()});var r=$(n).width();_.each(t,function(e){$(e).height(r)})};this.initGame=function(){e=o.INITIAL;var t=this;$(".icon-repeat").click(function(){t.startGame()})};this.startGame=function(){e=o.START;t=0;s=_.range(_.size(i));$("#timer").show();$("#replay").hide();this.loadData()};this.endGame=function(){e=o.END;var n="<li><div class='content'>#</div></li>";n+="<li><div class='content'>#</div></li>";n+="<li><div class='content'>#</div></li>";n+="<li><div class='content'>#</div></li>";n+="<li><div class='content'>G</div></li>";n+="<li><div class='content'>A</div></li>";n+="<li><div class='content'>M</div></li>";n+="<li><div class='content'>E</div></li>";n+="<li><div class='content'>O</div></li>";n+="<li><div class='content'>V</div></li>";n+="<li><div class='content'>E</div></li>";n+="<li><div class='content'>R</div></li>";n+="<li><div class='content'>#</div></li>";n+="<li><div class='content'>#</div></li>";n+="<li><div class='content'>#</div></li>";n+="<li><div class='content'>#</div></li>";$(".game-grid").html(n);$("#timer").hide();$("#replay").show();$("#score-value").html(t);this.onResize();$("html, body").scrollTop($("#panel-container").offset().top);swal({title:"Congratulations!",text:"Your score is "+t+"! :D",imageUrl:"images/oo0oo.png"})};this.isGameStateInitial=function(){return e==o.INITIAL};this.isGameStateStart=function(){return e==o.START};this.isGameStateEnd=function(){return e==o.END}}