var XMing=XMing||{};XMing.GameStateManager=new function(){var d;var g=0;var f;var c;var a=[{available:["i"],special:"l"},{available:["O"],special:"0"},{available:["0"],special:"O"},{available:["5"],special:"S"},{available:["p"],special:"q"},{available:["8"],special:"3"},{available:["m"],special:"nn"},{available:["w"],special:"vv"},{available:["u"],special:"&#xB5;"},{available:["x"],special:"&#10008;"},{available:["d"],special:"cl"},{available:["O"],special:"Q"},{available:["3","6","8","9","0"],special:"S"},{available:["a","e","i","o","u"],special:"n"},{available:["v","w","x","y","z"],special:"u"},{available:["V","W","X","Y"],special:"M"}];var b=_.range(_.size(a));var e={INITIAL:"initial",START:"start",PAUSE:"pause",END:"end"};this.init=function(){window.addEventListener("resize",this.onResize.bind(this),false);this.initGame()};this.loadData=function(){var j=this;var k=_.sample(b);b=_.without(b,k);var n=a[k];var i=Math.ceil(15/_.size(n.available));var h=[];_.times(i,function(){h=h.concat(n.available)});h=_.sample(h,15);var m=[];_.each(h,function(o){m.push("<li><div class='content animated fadeIn'>"+o+"</div></li>")});m.push("<li><div class='content animated fadeIn' data-special='true'>"+n.special+"</div></li>");m=_.shuffle(m);$(".game-grid").html("");_.each(m,function(o){$(".game-grid").append(o)});this.onResize();$("html, body").scrollTop($("#panel-container").offset().top);c=3.5;(function l(){c-=0.5;$("#timer-value").html(Math.ceil(c));$("#timer-value").addClass("animated fadeIn");$("#score-value").html(g);if(c<=0){clearTimeout(f);$("#result-content").html("Time's up!").addClass("animated bounceIn").css("color","rgba(17, 189, 255, 255)");$("#timer-value").removeClass("animated fadeIn");j.loadNextRound()}else{f=setTimeout(l,500)}})();$("ul.game-grid li").click(function(){if($(this.firstChild).data("special")){$("#result-content").html("Correct!").addClass("animated bounceIn").css("color","rgba(0, 255, 0, 255)");g+=c*10;$(".score-change").html("+"+c*10).css("color","rgba(0, 255, 0, 255)")}else{$("#result-content").html("Wrong!").addClass("animated bounceIn").css("color","rgba(255, 0, 0, 255)");g-=c*10;$(".score-change").html("-"+c*10).css("color","rgba(255, 0, 0, 255)")}$("#timer-value").removeClass("animated fadeIn");$("#score-value").html(g);$(".score-change").animate({top:"-25px"},{duration:1000,complete:function(){$(".score-change").html("").css("top","-10px")}});clearTimeout(f);j.loadNextRound()})};this.loadNextRound=function(){var h=this;var i=$("ul.game-grid");$("#result").width(i.width()).height(i.height()).show();_.delay(function(){$("#result").hide();if(_.size(b)>0){h.loadData()}else{h.endGame()}},1000)};this.onResize=function(k){var i=$(".game-grid").children("li");var h=_.max(i,function(l){return $(l).width()});var j=$(h).width();_.each(i,function(l){$(l).height(j)})};this.initGame=function(){d=e.INITIAL;var h=this;$(".icon-repeat").click(function(){h.startGame()})};this.startGame=function(){d=e.START;g=0;b=_.range(_.size(a));$("#timer").show();$("#replay").hide();this.loadData()};this.endGame=function(){d=e.END;var h="<li><div class='content'>#</div></li>";h+="<li><div class='content'>#</div></li>";h+="<li><div class='content'>#</div></li>";h+="<li><div class='content'>#</div></li>";h+="<li><div class='content'>G</div></li>";h+="<li><div class='content'>A</div></li>";h+="<li><div class='content'>M</div></li>";h+="<li><div class='content'>E</div></li>";h+="<li><div class='content'>O</div></li>";h+="<li><div class='content'>V</div></li>";h+="<li><div class='content'>E</div></li>";h+="<li><div class='content'>R</div></li>";h+="<li><div class='content'>#</div></li>";h+="<li><div class='content'>#</div></li>";h+="<li><div class='content'>#</div></li>";h+="<li><div class='content'>#</div></li>";$(".game-grid").html(h);$("#timer").hide();$("#replay").show();$("#score-value").html(g);this.onResize();$("html, body").scrollTop($("#panel-container").offset().top);swal({title:"Congratulations!",text:"Your score is "+g+"! :D",imageUrl:"images/oo0oo.png"})};this.isGameStateInitial=function(){return d==e.INITIAL};this.isGameStateStart=function(){return d==e.START};this.isGameStateEnd=function(){return d==e.END}};